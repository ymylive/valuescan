            def chart_ready_callback(task_id, symbol, chart_data):
                """å›¾è¡¨ç”Ÿæˆå®Œæˆåçš„å›è°ƒ - ç¼–è¾‘å·²å‘é€çš„æ¶ˆæ¯æ·»åŠ å›¾ç‰‡"""
                try:
                    if chart_data:
                        # æ·»åŠ å°å¹…éšæœºå»¶è¿Ÿé¿å…å¤šä¸ªç¼–è¾‘è¯·æ±‚å†²çª
                        import random
                        delay = random.uniform(0.5, 2.0)  # 0.5-2ç§’éšæœºå»¶è¿Ÿ
                        logger.info(f"ğŸ“Š å›¾è¡¨ç”Ÿæˆå®Œæˆï¼Œç­‰å¾… {delay:.1f}ç§’åç¼–è¾‘èåˆä¿¡å·: ${symbol} (ä»»åŠ¡ID: {task_id})")
                        time.sleep(delay)
                        
                        # ç¼–è¾‘å·²å‘é€çš„æ¶ˆæ¯ï¼Œå°†å…¶æ›¿æ¢ä¸ºå›¾ç‰‡æ¶ˆæ¯
                        edit_result = edit_message_with_photo(
                            message_id,
                            chart_data, 
                            caption=message  # ä½¿ç”¨å®Œæ•´çš„èåˆä¿¡å·æ–‡å­—ä½œä¸ºå›¾ç‰‡è¯´æ˜
                        )
                        if edit_result:
                            logger.info(f"âœ… èåˆä¿¡å·æ¶ˆæ¯ç¼–è¾‘æˆåŠŸï¼ˆæ·»åŠ å›¾ç‰‡ï¼‰: ${symbol}")
                        else:
                            logger.warning(f"âš ï¸ æ¶ˆæ¯ç¼–è¾‘å¤±è´¥ï¼Œä½†æ–‡å­—æ¶ˆæ¯å·²å‘é€: ${symbol}")
                    else:
                        logger.warning(f"âš ï¸ å›¾è¡¨ç”Ÿæˆå¤±è´¥ï¼Œä¿æŒæ–‡å­—æ¶ˆæ¯: ${symbol}")
                except Exception as e:
                    logger.error(f"âŒ å›¾è¡¨å›è°ƒå¤„ç†å¼‚å¸¸: {e}")
            
            # æäº¤å¼‚æ­¥å›¾è¡¨ç”Ÿæˆä»»åŠ¡
            task_id = generate_tradingview_chart_async(symbol, callback=chart_ready_callback)
            logger.info(f"ğŸ”„ å·²å¯åŠ¨å¼‚æ­¥å›¾è¡¨ç”Ÿæˆï¼Œå®Œæˆåç¼–è¾‘æ¶ˆæ¯: ${symbol} (ä»»åŠ¡ID: {task_id})")
            
        except Exception as e:
            logger.warning(f"âš ï¸ å¼‚æ­¥å›¾è¡¨ç”Ÿæˆå¯åŠ¨å¤±è´¥: {e}")
